<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5í•™ë…„ ê³¼í•™: ì‚°ê³¼ ì—¼ê¸° ì§€ì‹œì•½ ì‹¤í—˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        #app-container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 900px;
            width: 100%;
        }
        .well-plate {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            padding: 20px;
            background-color: #e0e7ff; /* í™ˆíŒ ë°°ê²½ìƒ‰ */
            border-radius: 10px;
            position: relative;
            margin: 0 auto;
            max-width: 600px; /* í™ˆíŒ ì „ì²´ ë„ˆë¹„ ì œí•œ */
        }
        .well-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        /* ì´ë¦„í‘œ ìŠ¤íƒ€ì¼: ë…¸ë€ ë°•ìŠ¤ í˜•íƒœ */
        .well-label {
            padding: 4px 10px;
            border-radius: 6px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            background-color: #fffacb; /* ì—°í•œ ë…¸ë‘ ë°°ê²½ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: absolute;
            font-size: 1.1rem; /* ê¸€ì”¨ì²´ í™•ëŒ€ */
            font-weight: bold;
            color: #1a202c; /* ì§™ì€ ìƒ‰ */
            white-space: nowrap;
            line-height: 1.2;
            text-align: center;
            left: 50%;
            transform: translateX(-50%);
            z-index: 5; /* í™ˆíŒ ìœ„ì— ì˜¤ë„ë¡ */
        }
        /* ìœ—ì¤„ ì´ë¦„í‘œ ìœ„ì¹˜ */
        .well-wrapper:nth-child(-n+3) .well-label {
            top: -45px; /* í™ˆ ìœ„ì— ë°°ì¹˜ */
        }
        /* ì•„ë«ì¤„ ì´ë¦„í‘œ ìœ„ì¹˜ */
        .well-wrapper:nth-child(n+4) .well-label {
            bottom: -45px; /* í™ˆ ì•„ë˜ì— ë°°ì¹˜ */
        }

        .well {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 2px solid #a7b7ff; /* í™ˆ í…Œë‘ë¦¬ */
            background-color: #f8fafc; /* ê¸°ë³¸ í™ˆ ìƒ‰ìƒ */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; 
            position: relative;
            cursor: pointer;
        }
        .solution {
            width: 95%;
            height: 95%;
            border-radius: 50%;
            position: relative;
            background-color: transparent; 
            transition: background-color 0.5s ease-out; /* í˜ë†€í”„íƒˆë ˆì¸ ìš©ì•¡ ë³€í™” ì†ë„ */
        }
        .indicator-strip {
            position: absolute;
            width: 35px; /* í¬ê¸° í™•ëŒ€ */
            height: 105px; /* í¬ê¸° í™•ëŒ€ */
            background-color: #ffcccc; /* ë¶‰ì€ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ ê¸°ë³¸ */
            border-radius: 3px;
            pointer-events: none; 
            z-index: 10;
            display: none; 
            transition: background 3s ease-in-out; /* ëŠë¦° ìƒ‰ ë³€í™”ë¥¼ ìœ„í•œ íŠ¸ëœì§€ì…˜ */
        }
        .phenolphthalein-dropper {
            position: absolute;
            width: 50px;
            height: 100px;
            /* SVG: ì ì ë³‘ ëª¨ì–‘ */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 200"><rect x="30" y="0" width="40" height="50" rx="10" ry="10" fill="%23a0a0a0"/><circle cx="50" cy="50" r="25" fill="%23a0a0a0"/><rect x="40" y="70" width="20" height="100" fill="%23cccccc"/><circle cx="50" cy="170" r="10" fill="%23cccccc"/></svg>');
            background-repeat: no-repeat;
            background-size: contain;
            cursor: grab;
            z-index: 20;
            display: none;
        }
        /* ë¬¼ë°©ìš¸ í¬ê¸° 2ë°° í™•ëŒ€ (10px -> 20px) */
        .drop-animation {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #b3e5fc; /* ì—°í•œ í•˜ëŠ˜ìƒ‰ ë¬¼ë°©ìš¸ */
            position: absolute;
            opacity: 0;
            animation: dropFade 0.8s forwards;
            pointer-events: none;
        }
        /* ë¬¼ë°©ìš¸ ì• ë‹ˆë©”ì´ì…˜ì˜ ì´ë™ ê±°ë¦¬ë„ í¬ê¸°ì— ë§ê²Œ ì¡°ì • */
        @keyframes dropFade {
            0% { transform: translate(-50%, -20px); opacity: 1; } /* ì‹œì‘ ìœ„ì¹˜ ì¡°ì • */
            100% { transform: translate(-50%, 30px); opacity: 0; } /* ë ìœ„ì¹˜ ì¡°ì • */
        }
    </style>
</head>
<body>
    <div id="app-container" class="text-center">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">ğŸ”¬ ì‚°ê³¼ ì—¼ê¸° ì§€ì‹œì•½ ì‹¤í—˜ ì‹œë®¬ë ˆì´ì…˜</h1>
        <p class="text-gray-600 mb-8">ì§€ì‹œì•½ì„ í™ˆíŒ ìš©ì•¡ì— ë„£ì–´ ìƒ‰ ë³€í™”ë¥¼ ê´€ì°°í•˜ê³  ìš©ì•¡ì˜ ì„±ì§ˆì„ ë¶„ë¥˜í•´ ë³´ì„¸ìš”.</p>

        <!-- ì§€ì‹œì•½ ì„ íƒ ë²„íŠ¼ -->
        <div class="flex justify-center space-x-4 mb-10">
            <button id="redLitmusBtn" class="px-6 py-3 bg-red-400 text-white font-semibold rounded-lg shadow-md hover:bg-red-500 transition duration-300">
                ë¶‰ì€ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´
            </button>
            <button id="blueLitmusBtn" class="px-6 py-3 bg-blue-400 text-white font-semibold rounded-lg shadow-md hover:bg-blue-500 transition duration-300">
                í‘¸ë¥¸ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´
            </button>
            <button id="phenolphthaleinBtn" class="px-6 py-3 bg-purple-400 text-white font-semibold rounded-lg shadow-md hover:bg-purple-500 transition duration-300">
                í˜ë†€í”„íƒˆë ˆì¸ ìš©ì•¡
            </button>
        </div>

        <!-- 6í™ˆíŒ -->
        <div class="well-plate" id="wellPlate">
            <!-- ìœ— ì¤„: í™ˆ ìœ„ì— ì´ë¦„í‘œ -->
            <div class="well-wrapper">
                <span class="well-label">ì‹ì´ˆ</span>
                <div class="well" id="well0"><div class="solution" data-type="acid"></div></div>
            </div>
            <div class="well-wrapper">
                <span class="well-label">íƒ„ì‚°ìˆ˜</span>
                <div class="well" id="well1"><div class="solution" data-type="acid"></div></div>
            </div>
            <div class="well-wrapper">
                <span class="well-label">ì„íšŒìˆ˜</span>
                <div class="well" id="well2"><div class="solution" data-type="base"></div></div>
            </div>
            <!-- ì•„ë« ì¤„: í™ˆ ì•„ë˜ì— ì´ë¦„í‘œ -->
            <div class="well-wrapper">
                <span class="well-label">ë¬½ì€ ì—¼ì‚°</span>
                <div class="well" id="well3"><div class="solution" data-type="acid"></div></div>
            </div>
            <div class="well-wrapper">
                <span class="well-label">ìœ ë¦¬ ì„¸ì •ì œ</span>
                <div class="well" id="well4"><div class="solution" data-type="base"></div></div>
            </div>
            <div class="well-wrapper">
                <span class="well-label">ë¬½ì€ ìˆ˜ì‚°í™” ë‚˜íŠ¸ë¥¨</span>
                <div class="well" id="well5"><div class="solution" data-type="base"></div></div>
            </div>
        </div>

        <!-- ë©”ì‹œì§€ ë° ì´ˆê¸°í™” ë²„íŠ¼ -->
        <div id="messageBox" class="text-red-500 mt-6 text-lg font-semibold h-7"></div>
        <button id="resetBtn" class="mt-8 px-8 py-4 bg-gray-600 text-white text-xl font-bold rounded-full shadow-lg hover:bg-gray-700 transition duration-300">
            ì²˜ìŒìœ¼ë¡œ
        </button>
    </div>

    <script>
        const wells = document.querySelectorAll('.well');
        const solutions = document.querySelectorAll('.solution');
        const redLitmusBtn = document.getElementById('redLitmusBtn');
        const blueLitmusBtn = document.getElementById('blueLitmusBtn');
        const phenolphthaleinBtn = document.getElementById('phenolphthaleinBtn');
        const resetBtn = document.getElementById('resetBtn');
        const messageBox = document.getElementById('messageBox');
        const appContainer = document.getElementById('app-container');

        // ìš©ì•¡ ì´ˆê¸° ìƒ‰ìƒ ì„¤ì •
        const initialSolutionColors = [
            '#fffacd', // ì‹ì´ˆ (ì—°í•œ ë…¸ë€ìƒ‰)
            'transparent', // íƒ„ì‚°ìˆ˜ (íˆ¬ëª…)
            'transparent', // ì„íšŒìˆ˜ (íˆ¬ëª…)
            'transparent', // ë¬½ì€ ì—¼ì‚° (íˆ¬ëª…)
            '#add8e6', // ìœ ë¦¬ ì„¸ì •ì œ (íŒŒë€ìƒ‰)
            'transparent' // ë¬½ì€ ìˆ˜ì‚°í™” ë‚˜íŠ¸ë¥¨ (íˆ¬ëª…)
        ];
        
        // í˜ë†€í”„íƒˆë ˆì¸ ìš©ì•¡ ë³€í™” íƒ€ê²Ÿ ìƒ‰ìƒ (ë³´ë¼ìƒ‰ì— ê°€ê¹Œìš´ ë°ì€ ìì£¼ìƒ‰)
        const PHENOLPHTHALEIN_BASE_COLOR = '#CC0066'; 
        
        // ì§€ì‹œì•½ í¬ê¸°ë¥¼ ë¯¸ë¦¬ ì •ì˜ (JavaScriptì—ì„œ ì˜¤í”„ì…‹ ê³„ì‚°ì— ì‚¬ìš©)
        const INDICATOR_SIZES = {
            'redLitmus': { width: 35, height: 105 },
            'blueLitmus': { width: 35, height: 105 },
            'phenolphthalein': { width: 50, height: 100 }
        };

        solutions.forEach((solution, index) => {
            solution.style.backgroundColor = initialSolutionColors[index];
        });

        let activeIndicator = null; 
        let draggedElement = null; 
        let isDragging = false;
        
        // ì§€ì‹œì•½ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„± í•¨ìˆ˜
        function createIndicatorElement(type) {
            let el;
            if (type === 'redLitmus' || type === 'blueLitmus') {
                el = document.createElement('div');
                el.classList.add('indicator-strip');
                el.style.background = (type === 'redLitmus' ? '#ffcccc' : '#a0c0ff'); 
                el.dataset.type = type;
            } else if (type === 'phenolphthalein') {
                el = document.createElement('div');
                el.classList.add('phenolphthalein-dropper');
                el.dataset.type = type;
            }
            el.style.position = 'absolute';
            el.style.zIndex = '100'; 
            el.style.display = 'block'; 
            appContainer.appendChild(el);
            return el;
        }

        // ë“œë˜ê·¸ ì‹œì‘ (ì»¤ì„œ ìœ„ì¹˜ì— ìƒì„±í•˜ë„ë¡ ìˆ˜ì •)
        function startDrag(e) {
            if (activeIndicator && !draggedElement) {
                draggedElement = createIndicatorElement(activeIndicator);
                isDragging = true;
                messageBox.textContent = ''; 

                const rect = appContainer.getBoundingClientRect();
                
                // ë¯¸ë¦¬ ì •ì˜ëœ í¬ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •í™•í•œ ì˜¤í”„ì…‹ ê³„ì‚°
                const size = INDICATOR_SIZES[activeIndicator];
                const width = size.width;
                const height = size.height;
                
                // **ìµœì¢… ìˆ˜ì •ëœ ë¶€ë¶„: ë§ˆìš°ìŠ¤ ì»¤ì„œ ìœ„ì¹˜ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ 150px - 20px = 130px ì´ë™**
                const OFFSET_X = 130; // ì˜¤ë¥¸ìª½ìœ¼ë¡œ 130px
                const OFFSET_Y = 0;   // Yì¶•ì€ ì¤‘ì•™ ìœ ì§€
                
                // ì´ˆê¸° ìƒì„± ìœ„ì¹˜ ì„¤ì •
                draggedElement.style.left = (e.clientX - rect.left - width / 2 + OFFSET_X) + 'px';
                draggedElement.style.top = (e.clientY - rect.top - height / 2 + OFFSET_Y) + 'px';
                
                function onMouseMove(e) {
                    if (isDragging && draggedElement) {
                        // ë“œë˜ê·¸ ì¤‘ì—ë„ ì»¤ì„œ ìœ„ì¹˜ì—ì„œ 130px ì˜¤ë¥¸ìª½ìœ¼ë¡œ ìœ ì§€
                        draggedElement.style.left = (e.clientX - rect.left - width / 2 + OFFSET_X) + 'px';
                        draggedElement.style.top = (e.clientY - rect.top - height / 2 + OFFSET_Y) + 'px';
                    }
                }

                function onMouseUp() {
                    isDragging = false;
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                }

                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            } else if (!activeIndicator) {
                 messageBox.textContent = "ì§€ì‹œì•½ì„ ì„ íƒí•´ ì£¼ì„¸ìš”!";
            }
        }

        // ì§€ì‹œì•½ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        redLitmusBtn.addEventListener('click', (event) => {
            if (activeIndicator && activeIndicator !== 'redLitmus') {
                messageBox.textContent = "'ì²˜ìŒìœ¼ë¡œ' ë²„íŠ¼ì„ ëˆ„ë¥¸ ë’¤ ë‹¤ì‹œ ì‹¤í–‰í•´ì£¼ì„¸ìš”.";
                return;
            }
            activeIndicator = 'redLitmus';
            messageBox.textContent = "ë¶‰ì€ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ë¥¼ ë“œë˜ê·¸í•˜ì—¬ í™ˆíŒì— ë„£ì–´ë³´ì„¸ìš”.";
            startDrag(event);
        });

        blueLitmusBtn.addEventListener('click', (event) => {
            if (activeIndicator && activeIndicator !== 'blueLitmus') {
                messageBox.textContent = "'ì²˜ìŒìœ¼ë¡œ' ë²„íŠ¼ì„ ëˆ„ë¥¸ ë’¤ ë‹¤ì‹œ ì‹¤í–‰í•´ì£¼ì„¸ìš”.";
                return;
            }
            activeIndicator = 'blueLitmus';
            messageBox.textContent = "í‘¸ë¥¸ìƒ‰ ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ë¥¼ ë“œë˜ê·¸í•˜ì—¬ í™ˆíŒì— ë„£ì–´ë³´ì„¸ìš”.";
            startDrag(event);
        });

        phenolphthaleinBtn.addEventListener('click', (e) => {
            if (activeIndicator && activeIndicator !== 'phenolphthalein') {
                messageBox.textContent = "'ì²˜ìŒìœ¼ë¡œ' ë²„íŠ¼ì„ ëˆ„ë¥¸ ë’¤ ë‹¤ì‹œ ì‹¤í–‰í•´ì£¼ì„¸ìš”.";
                return;
            }
            activeIndicator = 'phenolphthalein';
            messageBox.textContent = "í˜ë†€í”„íƒˆë ˆì¸ ìŠ¤í¬ì´ë“œë¥¼ ë“œë˜ê·¸í•˜ì—¬ í™ˆíŒì— ìš©ì•¡ì„ ë–¨ì–´ëœ¨ë ¤ ë³´ì„¸ìš”.";
            startDrag(e);
        });


        // í™ˆíŒì— ì§€ì‹œì•½ ë“œë¡­ & í´ë¦­
        wells.forEach((well, index) => {
            well.addEventListener('click', (e) => {
                // í´ë¦­ ì‹œì ì— draggedElementê°€ ìˆê³ , ì•„ì§ ë“œë˜ê·¸ ì¤‘ì´ ì•„ë‹ˆì–´ì•¼ í•¨ (ë“œë¡­ í›„ í´ë¦­ ì²˜ë¦¬)
                if (draggedElement && !isDragging && activeIndicator) {
                    const solutionDiv = well.querySelector('.solution');
                    const solutionType = solutionDiv.dataset.type;
                    const wellPlate = document.getElementById('wellPlate');

                    if (activeIndicator === 'redLitmus' || activeIndicator === 'blueLitmus') {
                        // ë¦¬íŠ¸ë¨¸ìŠ¤ ì¢…ì´ ì²˜ë¦¬
                        const litmusType = draggedElement.dataset.type;
                        
                        const wellRect = well.getBoundingClientRect();
                        const wellPlateRect = wellPlate.getBoundingClientRect();
                        const wellCenterX = wellRect.left + wellRect.width / 2;
                        const wellCenterY = wellRect.top + wellRect.height / 2;

                        const insertedStrip = document.createElement('div');
                        insertedStrip.classList.add('indicator-strip');
                        insertedStrip.style.position = 'absolute';
                        insertedStrip.style.display = 'block'; 
                        insertedStrip.style.transition = 'background 3s ease-in-out'; 

                        // í¬ê¸° ì •ë³´ ì‚¬ìš©
                        const stripWidth = INDICATOR_SIZES['redLitmus'].width;
                        const stripHeight = INDICATOR_SIZES['redLitmus'].height;

                        // 2/3 ì•ˆìª½, 1/3 ë°”ê¹¥ìª½ìœ¼ë¡œ ìœ„ì¹˜ ì¡°ì •
                        insertedStrip.style.left = (wellCenterX - wellPlateRect.left - stripWidth / 2) + 'px';
                        insertedStrip.style.top = (wellCenterY - wellPlateRect.top - stripHeight / 3) + 'px';
                        
                        let initialColor = '';
                        let finalColor = '';

                        if (litmusType === 'redLitmus') {
                            initialColor = '#ffcccc'; // ì—°í•œ ë¶‰ì€ìƒ‰
                            finalColor = '#a0c0ff'; // íŒŒë€ìƒ‰
                            
                            insertedStrip.style.background = `linear-gradient(to bottom, ${initialColor} 0%, ${initialColor} 100%)`;

                            if (solutionType === 'base') {
                                setTimeout(() => {
                                    // 3ì´ˆì— ê±¸ì³ ì „ì²´ ìƒ‰ìƒìœ¼ë¡œ ë³€í™”
                                    insertedStrip.style.background = `linear-gradient(to bottom, ${finalColor} 0%, ${finalColor} 100%)`;
                                }, 100); 
                            }
                        } else { // blueLitmus
                            initialColor = '#a0c0ff'; // í•˜ëŠ˜ìƒ‰
                            finalColor = '#ffcccc'; // ë¶‰ì€ìƒ‰
                            
                            insertedStrip.style.background = `linear-gradient(to bottom, ${initialColor} 0%, ${initialColor} 100%)`;

                            if (solutionType === 'acid') {
                                setTimeout(() => {
                                    // 3ì´ˆì— ê±¸ì³ ì „ì²´ ìƒ‰ìƒìœ¼ë¡œ ë³€í™”
                                    insertedStrip.style.background = `linear-gradient(to bottom, ${finalColor} 0%, ${finalColor} 100%)`;
                                }, 100);
                            }
                        }
                        
                        wellPlate.appendChild(insertedStrip); 

                    } else if (activeIndicator === 'phenolphthalein') {
                        // í˜ë†€í”„íƒˆë ˆì¸ ìš©ì•¡ ì²˜ë¦¬: ìŠ¤í¬ì´ë“œ ë“œë˜ê·¸ í›„ í´ë¦­í•˜ë©´ ë°”ë¡œ ë¬¼ë°©ìš¸ ë–¨ì–´ëœ¨ë¦¬ê¸°
                        
                        const dropWater = (delay) => {
                             setTimeout(() => {
                                const drop = document.createElement('div');
                                drop.classList.add('drop-animation');
                                
                                const wellRect = well.getBoundingClientRect();
                                const wellPlateRect = wellPlate.getBoundingClientRect();
                                const wellCenterX = wellRect.left + wellRect.width / 2;
                                const wellCenterY = wellRect.top + wellRect.height / 2;

                                drop.style.left = (wellCenterX - wellPlateRect.left) + 'px';
                                // ë¬¼ë°©ìš¸ í¬ê¸°(20px)ë¥¼ ê³ ë ¤í•˜ì—¬ ìŠ¤í¬ì´ë“œ ëì—ì„œ ë–¨ì–´ì§€ëŠ” ê²ƒì²˜ëŸ¼ ìœ„ì¹˜ ì¡°ì •
                                drop.style.top = (wellCenterY - wellPlateRect.top - 25) + 'px'; 

                                wellPlate.appendChild(drop);

                                drop.addEventListener('animationend', () => {
                                    drop.remove();
                                    if (delay === 100) { // ë§ˆì§€ë§‰ ë°©ìš¸ì´ ë–¨ì–´ì§ˆ ë•Œ ìš©ì•¡ ìƒ‰ìƒ ë³€ê²½
                                        if (solutionType === 'base') {
                                            solutionDiv.style.backgroundColor = PHENOLPHTHALEIN_BASE_COLOR; 
                                        }
                                    }
                                });
                            }, delay);
                        };

                        dropWater(0);
                        dropWater(100);
                    }
                    
                    // ì§€ì‹œì•½ ì—˜ë¦¬ë¨¼íŠ¸ ì œê±°
                    draggedElement.remove(); 
                    draggedElement = null; 
                }
            });
        });

        // ì´ˆê¸°í™” ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        resetBtn.addEventListener('click', () => {
            document.querySelectorAll('.indicator-strip, .phenolphthalein-dropper').forEach(el => el.remove());
            
            solutions.forEach((solution, index) => {
                solution.style.backgroundColor = initialSolutionColors[index];
            });

            activeIndicator = null;
            draggedElement = null;
            isDragging = false;
            messageBox.textContent = '';
        });
    </script>
</body>
</html>