<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5í•™ë…„ ê³¼í•™: ë¶‰ì€ ì–‘ë°°ì¶” ì§€ì‹œì•½ ì‹¤í—˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        #app-container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 900px;
            width: 100%;
        }
        .well-plate {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            padding: 20px;
            background-color: #e0e7ff; /* í™ˆíŒ ë°°ê²½ìƒ‰ */
            border-radius: 10px;
            position: relative;
            margin: 0 auto;
            max-width: 600px; /* í™ˆíŒ ì „ì²´ ë„ˆë¹„ ì œí•œ */
        }
        .well-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        /* ì´ë¦„í‘œ ìŠ¤íƒ€ì¼: ë…¸ë€ ë°•ìŠ¤ í˜•íƒœ (ì´ì „ íŒŒì¼ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€) */
        .well-label {
            padding: 4px 10px;
            border-radius: 6px;
            background-color: #fffacb; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: absolute;
            font-size: 1.1rem;
            font-weight: bold;
            color: #1a202c; 
            white-space: nowrap;
            line-height: 1.2;
            text-align: center;
            left: 50%;
            transform: translateX(-50%);
            z-index: 5;
        }
        .well-wrapper:nth-child(-n+3) .well-label {
            top: -45px;
        }
        .well-wrapper:nth-child(n+4) .well-label {
            bottom: -45px;
        }

        .well {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 2px solid #a7b7ff; 
            background-color: #f8fafc; 
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; 
            position: relative;
            cursor: pointer;
        }
        .solution {
            width: 95%;
            height: 95%;
            border-radius: 50%;
            position: relative;
            background-color: transparent; 
            transition: background-color 0.5s ease-out; /* ìš©ì•¡ ë³€í™” ì†ë„ */
        }
        .indicator-dropper { /* ë¶‰ì€ ì–‘ë°°ì¶” ì§€ì‹œì•½ìš© ìŠ¤í¬ì´ë“œ */
            position: absolute;
            width: 50px;
            height: 100px;
            /* SVG: ì ì ë³‘ ëª¨ì–‘ */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 200"><rect x="30" y="0" width="40" height="50" rx="10" ry="10" fill="%23a0a0a0"/><circle cx="50" cy="50" r="25" fill="%23a0a0a0"/><rect x="40" y="70" width="20" height="100" fill="%23cccccc"/><circle cx="50" cy="170" r="10" fill="%23cccccc"/></svg>');
            background-repeat: no-repeat;
            background-size: contain;
            cursor: grab;
            z-index: 20;
            display: none;
        }
        /* ë¬¼ë°©ìš¸ í¬ê¸° 2ë°° í™•ëŒ€ (20px) */
        .drop-animation {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #8A2BE2; /* ë³´ë¼ìƒ‰ ë¬¼ë°©ìš¸ */
            position: absolute;
            opacity: 0;
            animation: dropFade 0.8s forwards;
            pointer-events: none;
        }
        @keyframes dropFade {
            0% { transform: translate(-50%, -20px); opacity: 1; } 
            100% { transform: translate(-50%, 30px); opacity: 0; }
        }
    </style>
</head>
<body>
    <div id="app-container" class="text-center">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">ğŸ”¬ ë¶‰ì€ ì–‘ë°°ì¶” ì§€ì‹œì•½ ì‹¤í—˜ ì‹œë®¬ë ˆì´ì…˜</h1>
        <p class="text-center text-gray-600 mb-8">ì§€ì‹œì•½ì„ í™ˆíŒ ìš©ì•¡ì— ë„£ì–´ ìš©ì•¡ì˜ ì„±ì§ˆì— ë”°ë¥¸ ìƒ‰ ë³€í™”ë¥¼ ê´€ì°°í•´ ë³´ì„¸ìš”.</p>

        <!-- ì§€ì‹œì•½ ì„ íƒ ë²„íŠ¼ -->
        <div class="flex justify-center space-x-4 mb-10">
            <button id="redCabbageBtn" class="px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg shadow-md hover:bg-purple-700 transition duration-300">
                ë¶‰ì€ ì–‘ë°°ì¶” ì§€ì‹œì•½
            </button>
        </div>

        <!-- 6í™ˆíŒ -->
        <div class="well-plate" id="wellPlate">
            <!-- ìœ— ì¤„: í™ˆ ìœ„ì— ì´ë¦„í‘œ -->
            <div class="well-wrapper">
                <span class="well-label">ì‹ì´ˆ</span>
                <div class="well" id="well0"><div class="solution" data-type="acid-medium"></div></div>
            </div>
            <div class="well-wrapper">
                <span class="well-label">íƒ„ì‚°ìˆ˜</span>
                <div class="well" id="well1"><div class="solution" data-type="acid-weak"></div></div>
            </div>
            <div class="well-wrapper">
                <span class="well-label">ì„íšŒìˆ˜</span>
                <div class="well" id="well2"><div class="solution" data-type="base-weak"></div></div>
            </div>
            <!-- ì•„ë« ì¤„: í™ˆ ì•„ë˜ì— ì´ë¦„í‘œ -->
            <div class="well-wrapper">
                <span class="well-label">ë¬½ì€ ì—¼ì‚°</span>
                <div class="well" id="well3"><div class="solution" data-type="acid-strong"></div></div>
            </div>
            <div class="well-wrapper">
                <span class="well-label">ìœ ë¦¬ ì„¸ì •ì œ</span>
                <div class="well" id="well4"><div class="solution" data-type="base-medium"></div></div>
            </div>
            <div class="well-wrapper">
                <span class="well-label">ë¬½ì€ ìˆ˜ì‚°í™” ë‚˜íŠ¸ë¥¨</span>
                <div class="well" id="well5"><div class="solution" data-type="base-strong"></div></div>
            </div>
        </div>

        <!-- ë©”ì‹œì§€ ë° ì´ˆê¸°í™” ë²„íŠ¼ -->
        <div id="messageBox" class="text-red-500 mt-6 text-lg font-semibold h-7"></div>
        <button id="resetBtn" class="mt-8 px-8 py-4 bg-gray-600 text-white text-xl font-bold rounded-full shadow-lg hover:bg-gray-700 transition duration-300">
            ì²˜ìŒìœ¼ë¡œ
        </button>
    </div>

    <script>
        const wells = document.querySelectorAll('.well');
        const solutions = document.querySelectorAll('.solution');
        const redCabbageBtn = document.getElementById('redCabbageBtn');
        const resetBtn = document.getElementById('resetBtn');
        const messageBox = document.getElementById('messageBox');
        const appContainer = document.getElementById('app-container');

        // ìš©ì•¡ ì´ˆê¸° ìƒ‰ìƒ ì„¤ì •
        const initialSolutionColors = [
            '#fffacd', // ì‹ì´ˆ (ì—°í•œ ë…¸ë€ìƒ‰)
            'transparent', // íƒ„ì‚°ìˆ˜ (íˆ¬ëª…)
            'transparent', // ì„íšŒìˆ˜ (íˆ¬ëª…)
            'transparent', // ë¬½ì€ ì—¼ì‚° (íˆ¬ëª…)
            '#add8e6', // ìœ ë¦¬ ì„¸ì •ì œ (íŒŒë€ìƒ‰)
            'transparent' // ë¬½ì€ ìˆ˜ì‚°í™” ë‚˜íŠ¸ë¥¨ (íˆ¬ëª…)
        ];
        
        // ë¶‰ì€ ì–‘ë°°ì¶” ì§€ì‹œì•½ì— ë”°ë¥¸ ìµœì¢… ìƒ‰ìƒ ì •ì˜
        const RED_CABBAGE_COLORS = {
            'acid-strong': '#DC143C',   
            'acid-medium': '#C71585',   
            'acid-weak': '#FF69B4',     
            'base-weak': '#00BFFF',     
            'base-medium': '#3399FF',   
            'base-strong': '#ADFF2F'    
        };
        
        // ì§€ì‹œì•½ í¬ê¸°ë¥¼ ë¯¸ë¦¬ ì •ì˜ (JavaScriptì—ì„œ ì˜¤í”„ì…‹ ê³„ì‚°ì— ì‚¬ìš©)
        const INDICATOR_SIZES = {
            'redCabbage': { width: 50, height: 100 } // ìŠ¤í¬ì´ë“œ í¬ê¸°
        };

        solutions.forEach((solution, index) => {
            solution.style.backgroundColor = initialSolutionColors[index];
        });

        let activeIndicator = null; 
        let draggedElement = null; 
        let isDragging = false;
        
        // ì§€ì‹œì•½ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„± í•¨ìˆ˜ (ìŠ¤í¬ì´ë“œ ì „ìš©)
        function createIndicatorElement(type) {
            let el = document.createElement('div');
            el.classList.add('indicator-dropper');
            el.dataset.type = type;
            el.style.position = 'absolute';
            el.style.zIndex = '100'; 
            el.style.display = 'block'; 
            appContainer.appendChild(el);
            return el;
        }

        // ë“œë˜ê·¸ ì‹œì‘ (ì»¤ì„œ ìœ„ì¹˜ì— ìƒì„± + 130px ì˜¤í”„ì…‹)
        function startDrag(e) {
            if (activeIndicator && !draggedElement) {
                draggedElement = createIndicatorElement(activeIndicator);
                isDragging = true;
                messageBox.textContent = ''; 

                // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ì—ì„œ ë·°í¬íŠ¸ ê¸°ì¤€ ì¢Œí‘œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
                const clientX = e.clientX;
                const clientY = e.clientY;

                // app-containerì˜ ë·°í¬íŠ¸ ê¸°ì¤€ ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
                const rect = appContainer.getBoundingClientRect();
                
                const size = INDICATOR_SIZES[activeIndicator];
                const width = size.width;
                const height = size.height;
                
                // ìµœì¢… ì˜¤í”„ì…‹: ë§ˆìš°ìŠ¤ ì»¤ì„œ ì¤‘ì•™ìœ¼ë¡œë¶€í„° ì˜¤ë¥¸ìª½ìœ¼ë¡œ 130px - 20px = 110px
                // (150px - 20px = 130px ì˜€ìœ¼ë‚˜, ë‹¤ì‹œ ì™¼ìª½ìœ¼ë¡œ 20px ì´ë™ ìš”ì²­ì— ë”°ë¼ 110pxë¡œ ì¡°ì •)
                const OFFSET_X = 110; 
                const OFFSET_Y = 0;   
                
                // ì´ˆê¸° ìƒì„± ìœ„ì¹˜ ì„¤ì •
                // clientX/YëŠ” ë·°í¬íŠ¸ ê¸°ì¤€, rect.left/topë„ ë·°í¬íŠ¸ ê¸°ì¤€ì…ë‹ˆë‹¤.
                // clientX/Y - rect.left/top = appContainer ë‚´ì—ì„œì˜ ìƒëŒ€ ìœ„ì¹˜
                draggedElement.style.left = (clientX - rect.left - width / 2 + OFFSET_X) + 'px';
                draggedElement.style.top = (clientY - rect.top - height / 2 + OFFSET_Y) + 'px';
                
                function onMouseMove(e) {
                    if (isDragging && draggedElement) {
                        const newClientX = e.clientX;
                        const newClientY = e.clientY;
                        
                        // ë“œë˜ê·¸ ì¤‘ì—ë„ ì»¤ì„œ ìœ„ì¹˜ì—ì„œ 110px ì˜¤ë¥¸ìª½ìœ¼ë¡œ ìœ ì§€
                        draggedElement.style.left = (newClientX - rect.left - width / 2 + OFFSET_X) + 'px';
                        draggedElement.style.top = (newClientY - rect.top - height / 2 + OFFSET_Y) + 'px';
                    }
                }

                function onMouseUp() {
                    isDragging = false;
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                }

                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            } else if (!activeIndicator) {
                 messageBox.textContent = "ì§€ì‹œì•½ì„ ì„ íƒí•´ ì£¼ì„¸ìš”!";
            }
        }

        // ë¶‰ì€ ì–‘ë°°ì¶” ì§€ì‹œì•½ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        redCabbageBtn.addEventListener('click', (event) => {
            activeIndicator = 'redCabbage';
            messageBox.textContent = "ë¶‰ì€ ì–‘ë°°ì¶” ìŠ¤í¬ì´ë“œë¥¼ ë“œë˜ê·¸í•˜ì—¬ í™ˆíŒì— ìš©ì•¡ì„ ë–¨ì–´ëœ¨ë ¤ ë³´ì„¸ìš”.";
            startDrag(event);
        });


        // í™ˆíŒì— ì§€ì‹œì•½ í´ë¦­ ì´ë²¤íŠ¸
        wells.forEach((well) => {
            well.addEventListener('click', () => {
                // í´ë¦­ ì‹œì ì— ë“œë˜ê·¸ ìš”ì†Œê°€ ìˆê³ , ë“œë˜ê·¸ê°€ ëë‚¬ì„ ë•Œë§Œ ì²˜ë¦¬
                if (draggedElement && !isDragging && activeIndicator === 'redCabbage') {
                    const solutionDiv = well.querySelector('.solution');
                    const solutionStrength = solutionDiv.dataset.type; // ì˜ˆ: acid-strong, base-weak
                    const wellPlate = document.getElementById('wellPlate');

                    // ë¬¼ë°©ìš¸ ì• ë‹ˆë©”ì´ì…˜ ë° ìƒ‰ ë³€í™” ì²˜ë¦¬
                    
                    const dropWater = (delay) => {
                         setTimeout(() => {
                            const drop = document.createElement('div');
                            drop.classList.add('drop-animation');
                            
                            const wellRect = well.getBoundingClientRect();
                            const wellPlateRect = wellPlate.getBoundingClientRect();
                            const wellCenterX = wellRect.left + wellRect.width / 2;
                            const wellCenterY = wellRect.top + wellRect.height / 2;

                            drop.style.left = (wellCenterX - wellPlateRect.left) + 'px';
                            // ë¬¼ë°©ìš¸ í¬ê¸°ë¥¼ ê³ ë ¤í•œ ì‹œì‘ ìœ„ì¹˜
                            drop.style.top = (wellCenterY - wellPlateRect.top - 25) + 'px'; 

                            wellPlate.appendChild(drop);

                            drop.addEventListener('animationend', () => {
                                drop.remove();
                                if (delay === 100) { // ë§ˆì§€ë§‰ ë°©ìš¸ì´ ë–¨ì–´ì§ˆ ë•Œ ìš©ì•¡ ìƒ‰ìƒ ë³€ê²½
                                    const finalColor = RED_CABBAGE_COLORS[solutionStrength];
                                    if (finalColor) {
                                        solutionDiv.style.backgroundColor = finalColor; 
                                    }
                                }
                            });
                        }, delay);
                    };

                    dropWater(0);   // ì²« ë²ˆì§¸ ë¬¼ë°©ìš¸
                    dropWater(100); // ë‘ ë²ˆì§¸ ë¬¼ë°©ìš¸
                    
                    // ì§€ì‹œì•½ ì—˜ë¦¬ë¨¼íŠ¸ ì œê±°
                    draggedElement.remove(); 
                    draggedElement = null; 
                }
            });
        });

        // ì´ˆê¸°í™” ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        resetBtn.addEventListener('click', () => {
            document.querySelectorAll('.indicator-dropper').forEach(el => el.remove());
            
            solutions.forEach((solution, index) => {
                solution.style.backgroundColor = initialSolutionColors[index];
            });

            activeIndicator = null;
            draggedElement = null;
            isDragging = false;
            messageBox.textContent = '';
        });
    </script>
</body>
</html>